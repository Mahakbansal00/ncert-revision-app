(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(6404)}])},6404:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return p}});var a=t(5893),l=t(7294);function n(e){let{file:s,uploadedPdfs:t}=e;return s?"all-uploaded"===s?t&&0!==t.length?(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"mb-2 font-medium",children:"PDF Viewer - All Uploaded PDFs"}),(0,a.jsx)("div",{className:"border rounded p-2 h-[70vh] overflow-auto space-y-4",children:t.map(e=>(0,a.jsx)("iframe",{src:e.path,className:"w-full h-96",title:"pdf-viewer-".concat(e.name),allow:"fullscreen"},e.path))})]}):(0,a.jsx)("div",{className:"p-6 text-gray-500",children:"No uploaded PDFs found."}):(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"mb-2 font-medium",children:"PDF Viewer"}),(0,a.jsx)("div",{className:"border rounded p-2 h-[70vh] overflow-auto",children:(0,a.jsx)("iframe",{src:s,className:"w-full h-full",title:"pdf-viewer",allow:"fullscreen"})})]}):(0,a.jsxs)("div",{className:"p-6 text-gray-500",children:["No PDF selected. Place PDFs in ",(0,a.jsx)("code",{children:"/public/pdfs/"})," and select one."]})}var r=t(3299);function i(e){let{isOpen:s,onClose:t}=e,[n,i]=(0,l.useState)(""),[c,d]=(0,l.useState)(""),[o,x]=(0,l.useState)(""),h=async e=>{e.preventDefault(),(await (0,r.signIn)("credentials",{email:n,password:c,redirect:!1})).error?x("Invalid credentials"):t()};return s?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Sign In"}),(0,a.jsxs)("form",{onSubmit:h,children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-gray-700 mb-2",children:"Email"}),(0,a.jsx)("input",{type:"email",value:n,onChange:e=>i(e.target.value),className:"w-full px-3 py-2 border rounded",required:!0})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-gray-700 mb-2",children:"Password"}),(0,a.jsx)("input",{type:"password",value:c,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 border rounded",required:!0})]}),o&&(0,a.jsx)("p",{className:"text-red-500 mb-4",children:o}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 bg-gray-300 rounded",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded",children:"Sign In"})]})]}),(0,a.jsx)("p",{className:"mt-4 text-sm text-gray-600",children:"Demo credentials: user@example.com / password"})]})}):null}function c(){let{data:e}=(0,r.useSession)(),[s,t]=(0,l.useState)(!1);return(0,a.jsxs)("header",{className:"bg-rose-300 rounded-lg p-4 flex items-center justify-between max-w-7xl mx-auto mb-4",children:[(0,a.jsxs)("div",{className:"text-4xl font-extrabold tracking-tight",style:{fontFamily:"'Fredoka One', cursive"},children:[(0,a.jsx)("span",{className:"text-pink-400",children:"Q"}),(0,a.jsx)("span",{className:"text-yellow-400",children:"U"}),(0,a.jsx)("span",{className:"text-green-300",children:"I"}),(0,a.jsx)("span",{className:"text-cyan-300",children:"Z"}),(0,a.jsx)("span",{className:"text-black",children:".com"})]}),(0,a.jsx)("div",{className:"flex items-center space-x-4",children:e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("span",{className:"font-semibold text-black",children:["Hello, ",e.user.name||e.user.email]}),(0,a.jsx)("button",{onClick:()=>(0,r.signOut)(),className:"bg-red-500 text-white font-semibold px-4 py-2 rounded-full hover:bg-red-600 border-2 border-black",children:"Sign out"})]}):(0,a.jsx)("button",{onClick:()=>t(!0),className:"bg-lime-300 text-black font-semibold px-4 py-2 rounded-full hover:bg-lime-400 border-2 border-black",children:"Sign in"})}),(0,a.jsx)(i,{isOpen:s,onClose:()=>t(!1)})]})}let d=[{name:"Start",icon:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-pink-400",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{d:"M3 12l9-9 9 9-9 9-9-9z"})})},{name:"Art & Literature",icon:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-gray-400",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{d:"M12 2a10 10 0 100 20 10 10 0 000-20z"})})},{name:"Entertainment",icon:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-yellow-400",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{d:"M12 2l3 7h7l-5.5 4 2 7-6-4-6 4 2-7-5.5-4h7l3-7z"})})},{name:"Geography",icon:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-cyan-600",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10"})})},{name:"History",icon:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-yellow-900",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{d:"M4 4h16v16H4z"})})},{name:"Languages",icon:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-yellow-200",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{d:"M12 2l4 20H8l4-20z"})})},{name:"Science & Nature",icon:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-green-600",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{d:"M12 2a10 10 0 0110 10H2a10 10 0 0110-10z"})})},{name:"Sports",icon:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-orange-600",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10"})})}];function o(){return(0,a.jsx)("nav",{className:"max-w-7xl mx-auto flex justify-between border-b border-gray-300 pb-2 mb-4",children:d.map(e=>(0,a.jsx)("div",{className:"flex flex-col items-center text-xs text-gray-600 cursor-pointer hover:text-black"},e.name))})}function x(e){let{selected:s,onSelect:t}=e,[n,r]=(0,l.useState)([]),[i,c]=(0,l.useState)(!1);(0,l.useEffect)(()=>{let e=localStorage.getItem("uploadedPdfs");e&&r(JSON.parse(e))},[]);let d=async e=>{let s=e.target.files[0];if(s){c(!0);try{let e=new FileReader;e.onload=async()=>{let a=e.result.split(",")[1],l=await fetch("/api/uploadPdf",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileName:s.name,fileData:a})}),i=await l.json();if(l.ok){let e={name:s.name,path:i.path},a=[...n,e];r(a),localStorage.setItem("uploadedPdfs",JSON.stringify(a)),t(e.path)}else alert("Upload failed: "+i.error)},e.readAsDataURL(s)}catch(e){console.error(e),alert("Upload failed")}finally{c(!1)}}};return(0,a.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"Source Selector"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("button",{onClick:()=>t("all-uploaded"),className:"w-full text-left p-2 rounded ".concat("all-uploaded"===s?"bg-indigo-50":""),children:"All uploaded PDFs"}),[{name:"NCERT Class XI Physics (sample)",path:"/pdfs/sample_ncert_class11_physics.pdf"}].map(e=>(0,a.jsx)("button",{onClick:()=>t(e.path),className:"w-full text-left p-2 rounded ".concat(s===e.path?"bg-indigo-50":""),children:e.name},e.path)),n.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between w-full rounded hover:bg-gray-50 p-2",children:[(0,a.jsxs)("button",{onClick:()=>t(e.path),className:"text-left flex-1 ".concat(s===e.path?"bg-indigo-50":""),children:[e.name," (uploaded)"]}),(0,a.jsx)("button",{onClick:()=>{let a=n.filter(s=>s.path!==e.path);r(a),localStorage.setItem("uploadedPdfs",JSON.stringify(a)),s===e.path&&t(null)},className:"ml-2 text-red-600 hover:text-red-800","aria-label":"Delete ".concat(e.name),title:"Delete ".concat(e.name),children:"âœ•"})]},e.path))]}),(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsx)("label",{className:"block text-sm",children:"Upload PDF"}),(0,a.jsx)("input",{type:"file",accept:"application/pdf",onChange:d,className:"mt-1",disabled:i}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:i?"Uploading...":"Upload your own PDF coursebook."})]})]})}function h(e){let{pdf:s}=e,[t,n]=(0,l.useState)(null),[r,i]=(0,l.useState)({}),[c,d]=(0,l.useState)(!1),[o,x]=(0,l.useState)(null),h=async()=>{d(!0);try{let e=await fetch("/api/generateQuiz",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({pdf:s})}),t=await e.json();n(t.quiz),i({}),x(null)}catch(e){console.error(e),alert("Failed to generate quiz")}finally{d(!1)}},m=async()=>{if(t)try{let e=await fetch("/api/gradeQuiz",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({quiz:t,answers:r})}),s=await e.json();x(s),alert("Scored: "+s.score+"/"+t.questions.length+"\n"+s.message);let a=JSON.parse(localStorage.getItem("quizAttempts")||"[]");a.push({quizId:t.quiz_id,score:s.score,total:t.questions.length,date:new Date().toISOString()}),localStorage.setItem("quizAttempts",JSON.stringify(a))}catch(e){console.error(e),alert("Failed to submit quiz")}};return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:h,disabled:c,className:"px-3 py-1 bg-indigo-600 text-white rounded",children:c?"Generating...":"Generate Quiz"}),(0,a.jsx)("button",{onClick:()=>{i({}),x(null)},disabled:!t,className:"px-3 py-1 bg-red-600 text-white rounded",children:"Clear Answers"})]}),(0,a.jsxs)("div",{className:"mt-4",children:[!t&&(0,a.jsx)("p",{className:"text-sm text-gray-500",children:'Click "Generate Quiz" to create questions from the selected PDF.'}),t&&0===t.questions.length&&(0,a.jsx)("p",{children:"No questions generated."}),t&&t.questions.length>0&&(0,a.jsxs)("div",{children:[t.questions.map(e=>(0,a.jsxs)("div",{className:"p-3 border rounded mb-2 bg-white",children:[(0,a.jsx)("div",{className:"font-medium",children:e.question}),"MCQ"===e.type&&e.options&&e.options.map((s,t)=>(0,a.jsxs)("button",{onClick:()=>!o&&i({...r,[e.id]:s}),className:"block w-full text-left p-2 rounded mt-1 hover:bg-gray-50 ".concat(o&&o.correctAnswers[e.id]===s?"bg-red-500 text-white":r[e.id]===s?"bg-green-500 text-white":""),children:[String.fromCharCode(65+t),". ",s]},t)),"MCQ"!==e.type&&(0,a.jsx)("textarea",{className:"w-full border rounded p-2 mt-2",onChange:s=>i({...r,[e.id]:s.target.value})}),e.source_pages&&(0,a.jsxs)("div",{className:"text-xs text-gray-500 mt-2",children:["Source pages: ",e.source_pages.join(", ")]})]},e.id)),(0,a.jsx)("div",{className:"flex gap-2 mt-4",children:(0,a.jsx)("button",{onClick:m,disabled:!t,className:"px-3 py-1 bg-green-600 text-white rounded",children:"Submit"})})]})]})]})}function m(e){let{pdf:s}=e,[t,n]=(0,l.useState)([{role:"assistant",text:"Hi! Ask me anything about the selected PDF. This chat uses a RAG placeholder."}]),[r,i]=(0,l.useState)(""),c=async()=>{if(!r)return;n(e=>[...e,{role:"user",text:r}]),i("");let e=await fetch("/api/ragQuery",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({pdf:s,query:r})}),t=await e.json();n(e=>[...e,{role:"assistant",text:t.answer}])};return(0,a.jsxs)("div",{className:"flex flex-col h-96",children:[(0,a.jsx)("div",{className:"flex-1 overflow-auto p-2 space-y-2",children:t.map((e,s)=>(0,a.jsx)("div",{className:"p-2 rounded ".concat("assistant"===e.role?"bg-gray-100":"bg-indigo-50 self-end"),children:(0,a.jsx)("div",{className:"text-sm",children:e.text})},s))}),(0,a.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,a.jsx)("input",{value:r,onChange:e=>i(e.target.value),className:"flex-1 border rounded p-2",placeholder:"Ask about the PDF..."}),(0,a.jsx)("button",{onClick:c,className:"px-3 py-2 bg-indigo-600 text-white rounded",children:"Send"})]})]})}function u(){let[e,s]=(0,l.useState)([]);(0,l.useEffect)(()=>{let e=[];try{e=JSON.parse(localStorage.getItem("quizAttempts")||"[]"),Array.isArray(e)||(e=[])}catch(s){e=[]}s(e)},[]);let t=e.length>0?e.reduce((e,s)=>e+s.score,0)/e.length:0,n=0===e.length?"No data":"Average score: ".concat(t.toFixed(2));return(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Tiny Dashboard"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{className:"p-3 bg-white rounded shadow",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Recent attempts"}),(0,a.jsx)("div",{className:"mt-2",children:0===e.length?"No attempts yet. Try a quiz.":"You have made ".concat(e.length," attempts.")})]}),(0,a.jsxs)("div",{className:"p-3 bg-white rounded shadow",children:[(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Strengths & Weaknesses"}),(0,a.jsx)("div",{className:"mt-2",children:n})]})]})]})}function p(){let[e,s]=(0,l.useState)(null),[t,r]=(0,l.useState)([]);return(0,l.useEffect)(()=>{s("/pdfs/sample_ncert_class11_physics.pdf");let e=localStorage.getItem("uploadedPdfs");e&&r(JSON.parse(e))},[]),(0,a.jsxs)("div",{className:"min-h-screen bg-cream-50 p-4",children:[(0,a.jsx)(c,{}),(0,a.jsx)(o,{}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"lg:col-span-1 space-y-4",children:[(0,a.jsx)(x,{selected:e,onSelect:s}),(0,a.jsx)(u,{})]}),(0,a.jsxs)("div",{className:"lg:col-span-3 space-y-4",children:[(0,a.jsx)("div",{className:"bg-white p-4 rounded shadow",children:(0,a.jsx)(n,{file:e,uploadedPdfs:t})}),(0,a.jsx)("div",{className:"bg-white p-4 rounded shadow",children:(0,a.jsx)(h,{pdf:e})}),(0,a.jsx)("div",{className:"bg-white p-4 rounded shadow",children:(0,a.jsx)(m,{pdf:e})})]})]})]})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);